# -*- coding: utf-8 -*-
# Author : Seungyeon Jo
# e-mail : syjo@seculayer.co.kr
# Powered by Seculayer Â© 2018 AI-Core Team

import re

from mlps.core.data.cnvrtr.ConvertAbstract import ConvertAbstract


class HexRemoveHeader(ConvertAbstract):
    def __init__(self, **kwargs):
        super().__init__(**kwargs)
        
    def apply(self, data):
        result = ''
        
        # check blank
        if self._isBlank(data) :
            return [result]
        
        try:
            result = re.sub('[^0-9a-fA-F]', '', data)
        except:
            result = data
        
        _len = len(result)
        
        if _len >= 93 and result[92] == '5' and result[93] == '0':
            result = result[104:_len]
        elif _len >= 93 and result[92] == '6' and result[93] == '0':
            result = result[117:_len]
        elif _len >= 93 and result[92] == '8' and result[93] == '0':
            result = result[132:_len]
        elif _len >= 29 and result[28] == '8' and result[29] == '5':
            result = result[84:_len]
        elif _len >= 124:
            result = result[124:_len]
 
        return [result.lower()]

    def _isBlank(self, _str):
        return not (_str and _str.strip())


if __name__ == "__main__":
    _str = "EC9790EBB3BCEB9DBCEC979020EAB090EC97BCEB9098EBA9B420EAB3A0EC97B4EAB3BC20EAB5ACED86A02C20EC84A4EC82AC20EAB099EC9D8020ECA69DEC8381EC9DB420EB8298ED8380EB8298EB8BA4EAB08020ECB69CED9888EBA19C20EC9DB4EC96B4ECA791EB8B88EB8BA42E0A0AECB998EC82ACEC9CA8EC9D8020ECB59CEB8C80203930252C20EAB090EC97BCEB9090EB8BA420ED9598EBA9B4203130EBAA8520ECA4912039EBAA85EC9DB420ECA3BDEC9D8420EC889820EC9E88EB8BA4EB8A9420EC9698EAB981EB8B88EB8BA42E0A0AECA780EB829C2032EC9B9420EAB8B0EB8B88EC9790EC849C20EC8B9CEC9E91EB909C20EC9790EBB3BCEB9DBCEB8A9420EC9DB8ECA091ED959C20EB9DBCEC9DB4EBB2A0EBA6ACEC95842C20EC8B9CEC9790EB9DBCEBA6ACEC98A8EC9D8420EB8498EC96B420EB8298EC9DB4ECA780EBA6ACEC9584EAB98CECA78020EBB288ECA18CEC8AB5EB8B88EB8BA42E0A0AECA780EAB888EAB98CECA7802031ECB29C323030EC97AC20EBAA85EC9DB420EAB090EC97BCEB8FBC20363732EBAA85EC9DB420EBAAA9EC88A8EC9D8420EC9E83EC9788EC8AB5EB8B88EB8BA42E0A0AED998DECBDA9EC9790EC849CEB8F8420EC9584EC8B9CEC958420ECA780EC97ADEC9790EC849CEB8A9420ECB298EC9D8CEC9CBCEBA19C20EAB090EC97BC20EC9D98EC8BACED9998EC9E90EAB08020EBB09CEC839DED9688EC8AB5EB8B88EB8BA42E0A0AEC9584ED9484EBA6ACECB9B4EBA5BC20EBB0A9EBACB8ED9688EB8D9820EC97ACEC84B120ED959C20EBAA85EC9DB420EC9CA0EC82AC20ECA69DEC8381EC9D8420EBB3B4EC9DB820EAB283EC9E85EB8B88EB8BA42E"
    print(HexRemoveHeader().apply(_str))
